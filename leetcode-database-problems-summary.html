<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>LeetCode - Database Problems Summary - Tower of Babel</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">




<style type="text/css">

/*some stuff for output/input prompts*/
div.cell{border:1px solid transparent;display:-webkit-box;-webkit-box-orient:vertical;-webkit-box-align:stretch;display:-moz-box;-moz-box-orient:vertical;-moz-box-align:stretch;display:box;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch}div.cell.selected{border-radius:4px;border:thin #ababab solid}
div.cell.edit_mode{border-radius:4px;border:thin #008000 solid}
div.cell{width:100%;padding:5px 5px 5px 0;margin:0;outline:none}
div.prompt{min-width:11ex;padding:.4em;margin:0;font-family:monospace;text-align:right;line-height:1.21429em}
@media (max-width:480px){div.prompt{text-align:left}}div.inner_cell{display:-webkit-box;-webkit-box-orient:vertical;-webkit-box-align:stretch;display:-moz-box;-moz-box-orient:vertical;-moz-box-align:stretch;display:box;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch;-webkit-box-flex:1;-moz-box-flex:1;box-flex:1;flex:1}
div.input_area{border:1px solid #cfcfcf;border-radius:4px;background:#f7f7f7;line-height:1.21429em}
div.prompt:empty{padding-top:0;padding-bottom:0}
div.input{page-break-inside:avoid;display:-webkit-box;-webkit-box-orient:horizontal;-webkit-box-align:stretch;display:-moz-box;-moz-box-orient:horizontal;-moz-box-align:stretch;display:box;box-orient:horizontal;box-align:stretch;}
div.inner_cell{width:90%;}
div.input_area{border:1px solid #cfcfcf;border-radius:4px;background:#f7f7f7;}
div.input_prompt{color:navy;border-top:1px solid transparent;}
div.output_wrapper{margin-top:5px;position:relative;display:-webkit-box;-webkit-box-orient:vertical;-webkit-box-align:stretch;display:-moz-box;-moz-box-orient:vertical;-moz-box-align:stretch;display:box;box-orient:vertical;box-align:stretch;width:100%;}
div.output_scroll{height:24em;width:100%;overflow:auto;border-radius:4px;-webkit-box-shadow:inset 0 2px 8px rgba(0, 0, 0, 0.8);-moz-box-shadow:inset 0 2px 8px rgba(0, 0, 0, 0.8);box-shadow:inset 0 2px 8px rgba(0, 0, 0, 0.8);}
div.output_collapsed{margin:0px;padding:0px;display:-webkit-box;-webkit-box-orient:vertical;-webkit-box-align:stretch;display:-moz-box;-moz-box-orient:vertical;-moz-box-align:stretch;display:box;box-orient:vertical;box-align:stretch;width:100%;}
div.out_prompt_overlay{height:100%;padding:0px 0.4em;position:absolute;border-radius:4px;}
div.out_prompt_overlay:hover{-webkit-box-shadow:inset 0 0 1px #000000;-moz-box-shadow:inset 0 0 1px #000000;box-shadow:inset 0 0 1px #000000;background:rgba(240, 240, 240, 0.5);}
div.output_prompt{color:darkred;}

a.anchor-link:link{text-decoration:none;padding:0px 20px;visibility:hidden;}
h1:hover .anchor-link,h2:hover .anchor-link,h3:hover .anchor-link,h4:hover .anchor-link,h5:hover .anchor-link,h6:hover .anchor-link{visibility:visible;}
/* end stuff for output/input prompts*/


.highlight-ipynb .hll { background-color: #ffffcc }
.highlight-ipynb  { background: #f8f8f8; }
.highlight-ipynb .c { color: #408080; font-style: italic } /* Comment */
.highlight-ipynb .err { border: 1px solid #FF0000 } /* Error */
.highlight-ipynb .k { color: #008000; font-weight: bold } /* Keyword */
.highlight-ipynb .o { color: #666666 } /* Operator */
.highlight-ipynb .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight-ipynb .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight-ipynb .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight-ipynb .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight-ipynb .gd { color: #A00000 } /* Generic.Deleted */
.highlight-ipynb .ge { font-style: italic } /* Generic.Emph */
.highlight-ipynb .gr { color: #FF0000 } /* Generic.Error */
.highlight-ipynb .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight-ipynb .gi { color: #00A000 } /* Generic.Inserted */
.highlight-ipynb .go { color: #888888 } /* Generic.Output */
.highlight-ipynb .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight-ipynb .gs { font-weight: bold } /* Generic.Strong */
.highlight-ipynb .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight-ipynb .gt { color: #0044DD } /* Generic.Traceback */
.highlight-ipynb .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight-ipynb .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight-ipynb .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight-ipynb .kp { color: #008000 } /* Keyword.Pseudo */
.highlight-ipynb .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight-ipynb .kt { color: #B00040 } /* Keyword.Type */
.highlight-ipynb .m { color: #666666 } /* Literal.Number */
.highlight-ipynb .s { color: #BA2121 } /* Literal.String */
.highlight-ipynb .na { color: #7D9029 } /* Name.Attribute */
.highlight-ipynb .nb { color: #008000 } /* Name.Builtin */
.highlight-ipynb .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight-ipynb .no { color: #880000 } /* Name.Constant */
.highlight-ipynb .nd { color: #AA22FF } /* Name.Decorator */
.highlight-ipynb .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight-ipynb .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight-ipynb .nf { color: #0000FF } /* Name.Function */
.highlight-ipynb .nl { color: #A0A000 } /* Name.Label */
.highlight-ipynb .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight-ipynb .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight-ipynb .nv { color: #19177C } /* Name.Variable */
.highlight-ipynb .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight-ipynb .w { color: #bbbbbb } /* Text.Whitespace */
.highlight-ipynb .mf { color: #666666 } /* Literal.Number.Float */
.highlight-ipynb .mh { color: #666666 } /* Literal.Number.Hex */
.highlight-ipynb .mi { color: #666666 } /* Literal.Number.Integer */
.highlight-ipynb .mo { color: #666666 } /* Literal.Number.Oct */
.highlight-ipynb .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight-ipynb .sc { color: #BA2121 } /* Literal.String.Char */
.highlight-ipynb .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight-ipynb .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight-ipynb .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight-ipynb .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight-ipynb .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight-ipynb .sx { color: #008000 } /* Literal.String.Other */
.highlight-ipynb .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight-ipynb .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight-ipynb .ss { color: #19177C } /* Literal.String.Symbol */
.highlight-ipynb .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight-ipynb .vc { color: #19177C } /* Name.Variable.Class */
.highlight-ipynb .vg { color: #19177C } /* Name.Variable.Global */
.highlight-ipynb .vi { color: #19177C } /* Name.Variable.Instance */
.highlight-ipynb .il { color: #666666 } /* Literal.Number.Integer.Long */
</style>

<style type="text/css">
/* Overrides of notebook CSS for static HTML export */
div.entry-content {
  overflow: visible;
  padding: 8px;
}
.input_area {
  padding: 0.2em;
}

a.heading-anchor {
 white-space: normal;
}

.rendered_html
code {
 font-size: .8em;
}

pre.ipynb {
  color: black;
  background: #f7f7f7;
  border: none;
  box-shadow: none;
  margin-bottom: 0;
  padding: 0;
  margin: 0px;
  font-size: 13px;
}

/* remove the prompt div from text cells */
div.text_cell .prompt {
    display: none;
}

/* remove horizontal padding from text cells, */
/* so it aligns with outer body text */
div.text_cell_render {
    padding: 0.5em 0em;
}

img.anim_icon{padding:0; border:0; vertical-align:middle; -webkit-box-shadow:none; -box-shadow:none}

div.collapseheader {
    width=100%;
    padding: 2px;
    cursor: pointer;
    font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;
}

</style>

<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
<script type="text/javascript">
init_mathjax = function() {
    if (window.MathJax) {
        // MathJax loaded
        MathJax.Hub.Config({
            tex2jax: {
                inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
            },
            displayAlign: 'left', // Change this to 'center' to center equations.
            "HTML-CSS": {
                styles: {'.MathJax_Display': {"margin": 0}}
            }
        });
        MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
    }
}
init_mathjax();
</script>
    <link href="/assets/favicon.ico" rel="icon">

<link rel="canonical" href="/leetcode-database-problems-summary.html">

        <meta name="author" content="Charlie Hu" />
        <meta name="keywords" content="LeetCode,Mysql" />
        <meta name="description" content="Description Here is a summary of LeetCode Database section. Source link 删除重复数据 Write a SQL query to delete all duplicate email entries in a table named Person, keeping only unique emails based on its smallest Id. +----+------------------+ | Id | Email | +----+------------------+ | 1 | john@example.com | | 2 | bob@example.com | | 3 | john@example.com …" />

        <meta property="og:site_name" content="Tower of Babel" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="LeetCode - Database Problems Summary"/>
        <meta property="og:url" content="/leetcode-database-problems-summary.html"/>
        <meta property="og:description" content="Description Here is a summary of LeetCode Database section. Source link 删除重复数据 Write a SQL query to delete all duplicate email entries in a table named Person, keeping only unique emails based on its smallest Id. +----+------------------+ | Id | Email | +----+------------------+ | 1 | john@example.com | | 2 | bob@example.com | | 3 | john@example.com …"/>
        <meta property="article:published_time" content="2017-07-05" />
            <meta property="article:section" content="SQL" />
            <meta property="article:tag" content="LeetCode" />
            <meta property="article:tag" content="Mysql" />
            <meta property="article:author" content="Charlie Hu" />



    <!-- Bootstrap -->
        <link rel="stylesheet" href="/theme/css/bootstrap.flatly.min.css" type="text/css"/>
    <link href="/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="/theme/css/pygments/native.css" rel="stylesheet">
    <link href="/theme/tipuesearch/tipuesearch.css" rel="stylesheet">
    <link rel="stylesheet" href="/theme/css/style.css" type="text/css"/>
        <link href="/static/css/custom.css" rel="stylesheet">





</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
	<div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="/" class="navbar-brand">
Tower of Babel            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                         <li><a href="/pages/about.html">
                             About
                          </a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li><span>
                <form class="navbar-search" action="/search.html">
                  <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input" required>
                </form></span>
              </li>
              <li><a href="/archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->
<!-- Banner -->
<!-- End Banner -->
<div class="container">
    <div class="row">
        <div class="col-sm-9">
            <ol class="breadcrumb">
                <li><a href="" title="Tower of Babel"><i class="fa fa-home fa-lg"></i></a></li>
                <li><a href="/category/sql.html" title="SQL">SQL</a></li>
                <li class="active">LeetCode - Database Problems Summary</li>
            </ol>
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="/leetcode-database-problems-summary.html"
                       rel="bookmark"
                       title="Permalink to LeetCode - Database Problems Summary">
                        LeetCode - Database Problems Summary
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2017-07-05T00:00:00+08:00"> Wed 05 July 2017</time>
    </span>





<span class="label label-default">Tags</span>
	<a href="/tag/leetcode.html">LeetCode</a>
        /
	<a href="/tag/mysql.html">Mysql</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <h3>Description</h3>
<p>Here is a summary of LeetCode Database section.</p>
<p><a href="https://leetcode.com/problemset/database/">Source link</a></p>
<h3>删除重复数据</h3>
<p>Write a SQL query to delete all duplicate email entries in a table named Person, keeping only unique emails based on its smallest Id.</p>
<div class="highlight"><pre><span></span><span class="err">+----+------------------+</span>
<span class="err">| Id | Email            |</span>
<span class="err">+----+------------------+</span>
<span class="err">| 1  | john@example.com |</span>
<span class="err">| 2  | bob@example.com  |</span>
<span class="err">| 3  | john@example.com |</span>
<span class="err">+----+------------------+</span>
<span class="err">Id is the primary key column for this table.</span>
</pre></div>


<p>For example, after running your query, the above Person table should have the following rows:</p>
<div class="highlight"><pre><span></span><span class="err">+----+------------------+</span>
<span class="err">| Id | Email            |</span>
<span class="err">+----+------------------+</span>
<span class="err">| 1  | john@example.com |</span>
<span class="err">| 2  | bob@example.com  |</span>
<span class="err">+----+------------------+</span>
</pre></div>


<blockquote>
<p>删除重复数据是非常普遍和基础的操作。首先我们可以用连接自身以及where条件过滤来完成。</p>
</blockquote>
<div class="highlight"><pre><span></span><span class="err">delete p1</span>
<span class="err">from Person p1,Person p2</span>
<span class="err">where p1.Email=p2.Email</span>
<span class="err">and p1.id&gt;p2.id</span>
</pre></div>


<blockquote>
<p>用子查询和min选出每个同名组中最小的id号，删除除了这些id以外的行。</p>
</blockquote>
<div class="highlight"><pre><span></span><span class="err">delete  from Person</span>
<span class="err">where id not in (select b.id from (select min(id) as id from Person group by Email) b)</span>
</pre></div>


<h3>排序问题</h3>
<p>Write a SQL query to rank scores. If there is a tie between two scores, both should have the same ranking. Note that after a tie, the next ranking number should be the next consecutive integer value. In other words, there should be no "holes" between ranks.</p>
<div class="highlight"><pre><span></span><span class="err">+----+-------+</span>
<span class="err">| Id | Score |</span>
<span class="err">+----+-------+</span>
<span class="err">| 1  | 3.50  |</span>
<span class="err">| 2  | 3.65  |</span>
<span class="err">| 3  | 4.00  |</span>
<span class="err">| 4  | 3.85  |</span>
<span class="err">| 5  | 4.00  |</span>
<span class="err">| 6  | 3.65  |</span>
<span class="err">+----+-------+</span>
</pre></div>


<p>For example, given the above Scores table, your query should generate the following report (order by highest score):</p>
<div class="highlight"><pre><span></span><span class="err">+-------+------+</span>
<span class="err">| Score | Rank |</span>
<span class="err">+-------+------+</span>
<span class="err">| 4.00  | 1    |</span>
<span class="err">| 4.00  | 1    |</span>
<span class="err">| 3.85  | 2    |</span>
<span class="err">| 3.65  | 3    |</span>
<span class="err">| 3.65  | 3    |</span>
<span class="err">| 3.50  | 4    |</span>
<span class="err">+-------+------+</span>
</pre></div>


<blockquote>
<p>这里用结果集中大于等于当前score的distinct行数来表示某分数在整个结果集中的序列。</p>
</blockquote>
<div class="highlight"><pre><span></span><span class="err">select s.Score, (select count(*) from (select distinct Score from Scores) s2 where s2.Score&gt;=s.Score) Rank</span>
<span class="err">from Scores s</span>
<span class="err">order by Rank asc</span>
</pre></div>


<h3>分组比较问题</h3>
<p>The Trips table holds all taxi trips. Each trip has a unique Id, while Client_Id and Driver_Id are both foreign keys to the Users_Id at the Users table. Status is an ENUM type of (‘completed’, ‘cancelled_by_driver’, ‘cancelled_by_client’).</p>
<div class="highlight"><pre><span></span><span class="err">+----+-----------+-----------+---------+--------------------+----------+</span>
<span class="err">| Id | Client_Id | Driver_Id | City_Id |        Status      |Request_at|</span>
<span class="err">+----+-----------+-----------+---------+--------------------+----------+</span>
<span class="err">| 1  |     1     |    10     |    1    |     completed      |2013-10-01|</span>
<span class="err">| 2  |     2     |    11     |    1    | cancelled_by_driver|2013-10-01|</span>
<span class="err">| 3  |     3     |    12     |    6    |     completed      |2013-10-01|</span>
<span class="err">| 4  |     4     |    13     |    6    | cancelled_by_client|2013-10-01|</span>
<span class="err">| 5  |     1     |    10     |    1    |     completed      |2013-10-02|</span>
<span class="err">| 6  |     2     |    11     |    6    |     completed      |2013-10-02|</span>
<span class="err">| 7  |     3     |    12     |    6    |     completed      |2013-10-02|</span>
<span class="err">| 8  |     2     |    12     |    12   |     completed      |2013-10-03|</span>
<span class="err">| 9  |     3     |    10     |    12   |     completed      |2013-10-03|</span>
<span class="err">| 10 |     4     |    13     |    12   | cancelled_by_driver|2013-10-03|</span>
<span class="err">+----+-----------+-----------+---------+--------------------+----------+</span>
</pre></div>


<p>The Users table holds all users. Each user has an unique Users_Id, and Role is an ENUM type of (‘client’, ‘driver’, ‘partner’).</p>
<div class="highlight"><pre><span></span><span class="err">+----------+--------+--------+</span>
<span class="err">| Users_Id | Banned |  Role  |</span>
<span class="err">+----------+--------+--------+</span>
<span class="err">|    1     |   No   | client |</span>
<span class="err">|    2     |   Yes  | client |</span>
<span class="err">|    3     |   No   | client |</span>
<span class="err">|    4     |   No   | client |</span>
<span class="err">|    10    |   No   | driver |</span>
<span class="err">|    11    |   No   | driver |</span>
<span class="err">|    12    |   No   | driver |</span>
<span class="err">|    13    |   No   | driver |</span>
<span class="err">+----------+--------+--------+</span>
</pre></div>


<p>Write a SQL query to find the cancellation rate of requests made by unbanned clients between Oct 1, 2013 and Oct 3, 2013. For the above tables, your SQL query should return the following rows with the cancellation rate being rounded to two decimal places.</p>
<div class="highlight"><pre><span></span><span class="err">+------------+-------------------+</span>
<span class="err">|     Day    | Cancellation Rate |</span>
<span class="err">+------------+-------------------+</span>
<span class="err">| 2013-10-01 |       0.33        |</span>
<span class="err">| 2013-10-02 |       0.00        |</span>
<span class="err">| 2013-10-03 |       0.50        |</span>
<span class="err">+------------+-------------------+</span>
</pre></div>


<blockquote>
<p>将数据集以时间分组，利用case when 来判断是否计入取消订单数。也可以用if语句。</p>
</blockquote>
<div class="highlight"><pre><span></span><span class="err">select t.Request_at as Day,</span>
<span class="err">round((sum(case when t.Status in (&quot;cancelled_by_driver&quot;,&quot;cancelled_by_client&quot;) then 1 else 0 end)/count(*)),2) as &quot;Cancellation Rate&quot;</span>
<span class="err">from Trips t inner join Users u on t.Client_Id =u.Users_Id</span>
<span class="err">where u.Banned &lt;&gt; &quot;Yes&quot;</span>
<span class="err">and t.Request_at between &quot;2013-10-01&quot; and &quot;2013-10-03&quot;</span>
<span class="err">group by t.Request_at</span>
</pre></div>


<p>The Employee table holds all employees. Every employee has an Id, and there is also a column for the department Id.</p>
<div class="highlight"><pre><span></span><span class="err">+----+-------+--------+--------------+</span>
<span class="err">| Id | Name  | Salary | DepartmentId |</span>
<span class="err">+----+-------+--------+--------------+</span>
<span class="err">| 1  | Joe   | 70000  | 1            |</span>
<span class="err">| 2  | Henry | 80000  | 2            |</span>
<span class="err">| 3  | Sam   | 60000  | 2            |</span>
<span class="err">| 4  | Max   | 90000  | 1            |</span>
<span class="err">| 5  | Janet | 69000  | 1            |</span>
<span class="err">| 6  | Randy | 85000  | 1            |</span>
<span class="err">+----+-------+--------+--------------+</span>
</pre></div>


<p>The Department table holds all departments of the company.</p>
<div class="highlight"><pre><span></span><span class="err">+----+----------+</span>
<span class="err">| Id | Name     |</span>
<span class="err">+----+----------+</span>
<span class="err">| 1  | IT       |</span>
<span class="err">| 2  | Sales    |</span>
<span class="err">+----+----------+</span>
</pre></div>


<p>Write a SQL query to find employees who earn the top three salaries in each of the department. For the above tables, your SQL query should return the following rows.</p>
<div class="highlight"><pre><span></span><span class="err">+------------+----------+--------+</span>
<span class="err">| Department | Employee | Salary |</span>
<span class="err">+------------+----------+--------+</span>
<span class="err">| IT         | Max      | 90000  |</span>
<span class="err">| IT         | Randy    | 85000  |</span>
<span class="err">| IT         | Joe      | 70000  |</span>
<span class="err">| Sales      | Henry    | 80000  |</span>
<span class="err">| Sales      | Sam      | 60000  |</span>
<span class="err">+------------+----------+--------+</span>
</pre></div>


<blockquote>
<p>取top3的分组数据和取最大分组salary有所不同。后者可以用where salary in （select max(salary) ..group by ）子查询语句来实现。
这里运用了排序问题中的思想。将当前salary与同一group中（表现为departmentid相等），大于等于当前distinct的salary的数量作为该salary的rank。其他限制条件就迎刃而解了。</p>
</blockquote>
<div class="highlight"><pre><span></span><span class="err">select d.Name Department, e1.Name Employee, e1.Salary</span>
<span class="err">from Employee e1</span>
<span class="err">join Department d</span>
<span class="err">on e1.DepartmentId = d.Id</span>
<span class="err">where 3 &gt; (select count(distinct(e2.Salary))</span>
<span class="err">                  from Employee e2</span>
<span class="err">                  where e2.Salary &gt; e1.Salary</span>
<span class="err">                  and e1.DepartmentId = e2.DepartmentId</span>
<span class="err">                  );</span>
</pre></div>
            </div>
            <!-- /.entry-content -->
<section class="well" id="related-posts">
    <h4>Related Posts:</h4>
    <ul>
        <li><a href="/leetcode-add-one-row-to-tree.html">LeetCode - Add One Row to Tree</a></li>
        <li><a href="/leetcode-find-bottom-left-tree-value.html">LeetCode - Find Bottom Left Tree Value</a></li>
        <li><a href="/leetcode-distribute-candies.html">LeetCode - Distribute Candies</a></li>
        <li><a href="/leetcode-integer-break.html">LeetCode - Integer Break</a></li>
        <li><a href="/leetcode-queue-reconstruction-by-height.html">LeetCode - Queue Reconstruction by Height</a></li>
    </ul>
</section>
        </article>
    </section>

        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>
<div id="aboutme">
        <p>
            <img width="100%" class="img-thumbnail" src="/assets/img/avatar.png"/>
        </p>
    <p>
      <strong>About Charlie Hu</strong><br/>
        Software engineer, Geeker. Here I mostly blog about Python, algorithm and how programing can be interesting.
    </p>
</div><!-- Sidebar -->
<section class="well well-sm">
  <ul class="list-group list-group-flush">

<!-- Sidebar/Social -->
<li class="list-group-item">
  <h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Social</span></h4>
  <ul class="list-group" id="social">
    <li class="list-group-item"><a href="https://github.com/Motor-taxi-master-rider"><i class="fa fa-github-square fa-lg"></i> github</a></li>
    <li class="list-group-item"><a href="https://weibo.com/u/3025131943"><i class="fa fa-weibo fa-lg"></i> weibo</a></li>
  </ul>
</li>
<!-- End Sidebar/Social -->

<!-- Sidebar/Recent Posts -->
<li class="list-group-item">
  <h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Recent Posts</span></h4>
  <ul class="list-group" id="recentposts">
    <li class="list-group-item"><a href="/translatezhang-wo-pythonbing-fa-rang-ni-geng-kuai-xiang-yong-wu-can.html">[Translate]掌握Python并发让你更快享用午餐</a></li>
    <li class="list-group-item"><a href="/translatecong-xin-shou-dao-zhuan-jia-ru-he-yong-pythonbian-xie-pei-zhi-wen-jian.html">[Translate]从新手到专家：如何用Python编写配置文件</a></li>
    <li class="list-group-item"><a href="/jian-dan-de-wen-ben-jie-xi-ji-suan-qi-v2.html">简单的文本解析计算器 v2</a></li>
  </ul>
</li>
<!-- End Sidebar/Recent Posts -->

<!-- Sidebar/Tag Cloud -->
<li class="list-group-item">
  <a href="/"><h4><i class="fa fa-tags fa-lg"></i><span class="icon-label">Tags</span></h4></a>
  <ul class="list-group list-inline tagcloud" id="tags">
    <li class="list-group-item tag-3">
      <a href="/tag/algorithms.html">Algorithms</a>
    </li>
    <li class="list-group-item tag-4">
      <a href="/tag/bit_manipulation.html">Bit_manipulation</a>
    </li>
    <li class="list-group-item tag-2">
      <a href="/tag/coroutine.html">Coroutine</a>
    </li>
    <li class="list-group-item tag-1">
      <a href="/tag/leetcode.html">Leetcode</a>
    </li>
    <li class="list-group-item tag-4">
      <a href="/tag/math.html">Math</a>
    </li>
    <li class="list-group-item tag-2">
      <a href="/tag/python.html">Python</a>
    </li>
    <li class="list-group-item tag-4">
      <a href="/tag/stack.html">Stack</a>
    </li>
    <li class="list-group-item tag-3">
      <a href="/tag/string.html">String</a>
    </li>
    <li class="list-group-item tag-4">
      <a href="/tag/translate.html">Translate</a>
    </li>
    <li class="list-group-item tag-2">
      <a href="/tag/tree.html">Tree</a>
    </li>
  </ul>
</li>
<!-- End Sidebar/Tag Cloud -->

<!-- Sidebar/Github -->
<li class="list-group-item">
  <h4><i class="fa fa-github fa-lg"></i><span class="icon-label">GitHub Repos</span></h4>
  <div id="gh_repos">
    <p class="list-group-item">Status updating...</p>
  </div>
  <a href="https://github.com/Motor-taxi-master-rider">@Motor-taxi-master-rider</a> on GitHub
</li>
<!-- End Sidebar/Github -->

<!-- Sidebar/Links -->
<li class="list-group-item">
  <h4><i class="fa fa-external-link-square fa-lg"></i><span class="icon-label">Links</span></h4>
  <ul class="list-group" id="links">
    <li class="list-group-item">
      <a href="http://getpelican.com/" target="_blank">Pelican</a>
    </li>
    <li class="list-group-item">
      <a href="http://python.org/" target="_blank">Python.org</a>
    </li>
    <li class="list-group-item">
      <a href="http://jinja.pocoo.org/" target="_blank">Jinja2</a>
    </li>
  </ul>
</li>
<!-- End Sidebar/Links -->
  </ul>
</section>
<!-- End Sidebar -->            </aside>
        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2021 Charlie Hu
            &middot; Powered by <a href="https://github.com/getpelican/pelican-themes/tree/master/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="/theme/js/respond.min.js"></script>

    <script src="/static/js/custom.js"></script>


<!-- GitHub JS Code -->
<script type="text/javascript">
$(document).ready(function () {
  if (!window.jXHR) {
    var jxhr = document.createElement('script');
    jxhr.type = 'text/javascript';
    jxhr.src = '/theme/js/jXHR.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(jxhr, s);
  }

  github.showRepos({
    user: 'Motor-taxi-master-rider',
    count: 3,
    skip_forks: true,
    target: '#gh_repos'
  });
});
</script>
<script src="/theme/js/github.js" type="text/javascript"></script>
<!-- End GitHub JS Code -->

<script type="text/javascript">
jQuery(document).ready(function($) {
    $("div.collapseheader").click(function () {
    $header = $(this).children("span").first();
    $codearea = $(this).children(".input_area");
    console.log($(this).children());
    $codearea.slideToggle(500, function () {
        $header.text(function () {
            return $codearea.is(":visible") ? "Collapse Code" : "Expand Code";
        });
    });
});
});
</script>
</body>
</html>